# name: test/geoparquet/unsupported.test
# group: [geoparquet]

require spatial

require parquet

#------------------------------------------------------------------------------
# Test unsupported geometry type
#------------------------------------------------------------------------------
# This is now ok, but we dont write the geoparquet metadata

statement ok
COPY (SELECT 'POINT ZM (0 1 2 3)'::GEOMETRY) TO '__TEST_DIR__/t1.parquet' (FORMAT 'parquet');

query I
SELECT (decode(value)) as col
FROM parquet_kv_metadata('__TEST_DIR__/t1.parquet');
----

statement ok
COPY (SELECT 'POINT M (0 1 2)'::GEOMETRY) TO '__TEST_DIR__/t1.parquet' (FORMAT 'parquet');

query I
SELECT (decode(value)) as col
FROM parquet_kv_metadata('__TEST_DIR__/t1.parquet');
----
