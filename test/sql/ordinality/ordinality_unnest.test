# name: test/sql/ordinality/ordinality_unnest.test
# description: Test unnest function
# group: [ordinality]

statement ok
PRAGMA enable_verification


statement ok
CREATE TABLE test(a char[]);


statement ok
INSERT INTO test VALUES (['a1','a2','a3']),(['b1','b2']);


query II
SELECT * FROM unnest([41,42,43]) WITH ORDINALITY;
----
41	1
42	2
43	3

query III
SELECT * FROM test AS t, LATERAL unnest(t.a) WITH ORDINALITY AS _(unnest,ordinality) ORDER BY unnest;
----
[a1, a2, a3]	a1	1
[a1, a2, a3]	a2	2
[a1, a2, a3]	a3	3
[b1, b2]	b1	1
[b1, b2]	b2	2