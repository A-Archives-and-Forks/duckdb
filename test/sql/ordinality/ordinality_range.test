# name: test/sql/ordinality/ordinality_range.test
# description: Test range function
# group: [ordinality]

statement ok
PRAGMA enable_verification


statement ok
CREATE TABLE test(a int);


statement ok
INSERT INTO test VALUES (1),(3);


query II
SELECT * FROM range(3) WITH ORDINALITY ORDER BY range,ordinality;
----
0	1
1	2
2	3


query III
SELECT * FROM test AS t, LATERAL range(t.a) WITH ORDINALITY AS _(range,ordinality) ORDER BY range;
----
1	0	1
3	0	1
3	1	2
3	2	3


query II
SELECT * FROM generate_series(0,3,1) WITH ORDINALITY ORDER BY generate_series, ordinality;
----
0	1
1	2
2	3
3	4


query III
SELECT * FROM test AS t, LATERAL generate_series(0,t.a,1) WITH ORDINALITY ORDER BY t.a, ordinality;
----
1	0	1
1	1	2
3	0	1
3	1	2
3	2	3
3	3	4
