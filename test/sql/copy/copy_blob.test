# name: test/sql/copy/copy_blob.test
# group: [copy]

statement error
COPY (select 'foo') TO 'test.blob' (FORMAT BLOB);
----
Binder Error: "COPY (FORMAT BLOB)" only supports a single BLOB column

statement error
COPY (select 'foo'::BLOB, 10) TO 'test.blob' (FORMAT BLOB);
----
Binder Error: "COPY (FORMAT BLOB)" only supports a single BLOB column


statement ok
COPY (select 'foo'::BLOB) TO 'test.blob' (FORMAT BLOB);

query III
select filename, content, size from read_blob('test.blob');
----
test.blob	foo	3


statement error
COPY (select 'foo'::BLOB) TO 'test.blob.gz' (FORMAT BLOB, ASDFGH);
----
Binder Error: Unrecognized option for COPY (FORMAT BLOB): "ASDFGH"

# With compression
statement ok
COPY (select 'foo'::BLOB) TO 'test.blob.gz' (FORMAT BLOB);

query II
select filename, size from read_blob('test.blob.gz');
----
test.blob.gz	26

# With explicit compression
statement ok
COPY (select 'foo'::BLOB) TO 'test2.blob' (FORMAT BLOB, COMPRESSION 'GZIP');

query II
select filename, size from read_blob('test2.blob');
----
test2.blob	26